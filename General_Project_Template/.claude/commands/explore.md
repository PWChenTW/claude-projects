---
name: explore
description: 探索階段 - 深入理解程式碼庫、需求和技術背景
---

# 探索命令 (Explore Command)

## 命令用途

`/explore [主題]` - 啟動深度探索模式，充分理解專案背景、程式碼結構和業務需求。

## 核心理念

> "Context is everything" - 在開始編碼前，充分的探索可以將成功率從 60% 提升到 95% 以上。

## 觸發時機

### 自動觸發
- 當用戶提出新功能需求時
- 當需要修改不熟悉的模組時
- 當遇到複雜的 bug 需要調查時
- 當 `/spec-init` 後自動進入探索階段

### 手動觸發
```bash
/explore authentication  # 探索認證模組
/explore database-layer  # 探索資料庫層
/explore [any-topic]     # 探索任何主題
```

## 工作流程

### 階段 1：廣度探索 (5-10 分鐘)
```bash
1. 專案結構掃描
   - 使用 `ls -la` 和 `tree` 了解目錄結構
   - 讀取 README.md 和專案文檔
   - 檢查 package.json/requirements.txt 了解依賴

2. 識別關鍵模組
   - 定位主要功能模組
   - 找出配置檔案
   - 識別測試檔案

3. 理解技術棧
   - 框架和函式庫版本
   - 設計模式使用
   - 程式碼風格慣例
```

### 階段 2：深度探索 (10-15 分鐘)
```bash
1. 程式碼模式分析
   - 使用 grep 尋找相似實作
   - 分析現有設計模式
   - 理解錯誤處理方式

2. 業務邏輯理解
   - 追蹤資料流
   - 理解業務規則
   - 識別邊界條件

3. 依賴關係映射
   - 模組間的依賴
   - 外部服務整合
   - 資料庫結構
```

### 階段 3：風險評估 (5 分鐘)
```bash
1. 技術風險識別
   - 性能瓶頸
   - 安全漏洞
   - 技術債

2. 實施挑戰評估
   - 複雜度評估
   - 時間估算
   - 資源需求
```

## 探索技巧

### 有效的探索命令
```bash
# 尋找相關檔案
find . -name "*auth*" -type f | head -20

# 搜尋程式碼模式
grep -r "class.*Controller" --include="*.py" --include="*.js"

# 分析檔案結構
ls -la src/ | head -20

# 查看最近修改
git log --oneline -n 20 -- path/to/module

# 理解資料流
grep -r "def.*process\|function.*process" --include="*.py" --include="*.js"
```

### 探索提問模板
```markdown
1. 架構問題
   - "這個模組的主要職責是什麼？"
   - "它如何與其他模組互動？"
   - "有哪些設計決策的原因？"

2. 實作問題
   - "現有的錯誤處理模式是什麼？"
   - "如何進行輸入驗證？"
   - "有哪些效能優化？"

3. 業務問題
   - "這個功能解決什麼業務問題？"
   - "有哪些業務規則和約束？"
   - "誰是主要使用者？"
```

## 輸出格式

### 探索報告模板
```markdown
# [主題] 探索報告
日期：[YYYY-MM-DD]

## 執行摘要
[3-5 句話總結關鍵發現]

## 程式碼結構分析
### 核心檔案
- `path/to/file1.py`: [職責描述]
- `path/to/file2.js`: [職責描述]

### 設計模式
- 模式 1: [描述和範例]
- 模式 2: [描述和範例]

### 依賴關係
```
Module A --> Module B
         --> Module C
Module B --> Database
```

## 業務邏輯理解
### 核心流程
1. [步驟 1]
2. [步驟 2]
3. [步驟 3]

### 業務規則
- 規則 1: [描述]
- 規則 2: [描述]

## 技術評估
### 使用的技術
- 框架: [名稱和版本]
- 函式庫: [列表]
- 工具: [列表]

### 現有最佳實踐
- 實踐 1: [描述]
- 實踐 2: [描述]

## 風險和挑戰
### 識別的風險
1. **風險名稱**: [描述和影響]
2. **風險名稱**: [描述和影響]

### 建議的緩解措施
- 風險 1: [緩解策略]
- 風險 2: [緩解策略]

## 下一步建議
1. [建議行動 1]
2. [建議行動 2]
3. [建議行動 3]
```

## 輸出位置

探索結果保存到：
- `.kiro/research/exploration/[date]-[topic].md` - 詳細探索報告
- `.kiro/context/current.md` - 更新當前上下文
- `.kiro/specs/[feature]/exploration.md` - 功能相關探索

## 與其他命令的關係

```mermaid
graph LR
    A[/explore] --> B[/plan]
    B --> C[/execute]
    C --> D[/verify]
    D --> A
```

- **後續命令**: 探索完成後，自動建議執行 `/plan`
- **前置命令**: 可由 `/spec-init` 自動觸發
- **並行命令**: 可與 `/context` 配合使用

## 成功指標

一個成功的探索應該能回答：
- ✅ 我完全理解要修改的程式碼嗎？
- ✅ 我知道現有的設計模式和慣例嗎？
- ✅ 我理解業務需求和約束嗎？
- ✅ 我識別了主要的風險和挑戰嗎？
- ✅ 我有信心制定實施計畫嗎？

## 注意事項

### ⚠️ 避免的陷阱
- 不要急於開始編碼
- 不要忽略現有模式
- 不要假設而不驗證
- 不要跳過風險評估

### 💡 最佳實踐
- 深度優於廣度
- 問"為什麼"而不只是"什麼"
- 記錄所有發現
- 與團隊分享探索結果

## 範例使用

### 場景 1：探索新功能區域
```bash
User: 我需要添加一個支付功能
Assistant: 讓我先探索現有的支付相關實作...

/explore payment-system

[執行探索流程]
[生成探索報告]

根據探索結果，我發現專案使用 Stripe API，
已有訂單處理模組，建議基於現有模式實作...
```

### 場景 2：調試複雜問題
```bash
User: 用戶報告登入有時會失敗
Assistant: 我需要深入探索認證系統...

/explore authentication-flow

[追蹤認證流程]
[分析錯誤模式]
[識別潛在原因]

探索發現 session 管理在高併發時有競態條件...
```

## 配置選項

在 `.claude/settings.json` 中配置：
```json
{
  "explore": {
    "auto_trigger": true,
    "depth": "deep",
    "save_reports": true,
    "report_format": "markdown",
    "time_limit": "20m"
  }
}
```

---

記住：**充分的探索是成功的一半**。寧可多花時間理解，也不要急於動手而走錯方向。